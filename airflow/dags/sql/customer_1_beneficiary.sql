COPY INTO raw_beneficiary (
    DESYNPUF_ID,
    BENEFICIARY_BIRTH_DATE,
    BENEFICIARY_DEATH_DATE,
    BENEFICIARY_SEX_ID_CODE,
    BENEFICIARY_RACE_CODE,
    BENEFICIARY_END_STAGE_RENAL_DISEASE_INDICATOR,
    STATE_CODE,
    BENEFICIARY_COUNTY_CODE,
    BENEFICIARY_HOSPITAL_INSURANCE_COVERAGE_TOTAL_MONTHS,
    BENEFICIARY_SUPPLEMENTARY_MEDICAL_INSURANCE_COVERAGE_TOTAL_MONTHS,
    BENEFICIARY_HEALTH_MAINTENANCE_ORGANIZATION_COVERAGE_TOTAL_MONTHS,
    PLAN_COVERAGE_MONTHS_NUMBER,
    ALZHEIMER_DISEASE_INDICATOR,
    CONGESTIVE_HEART_FAILURE_INDICATOR,
    CHRONIC_KIDNEY_DISEASE_INDICATOR,
    CANCER_INDICATOR,
    CHRONIC_OBSTRUCTIVE_PULMONARY_DISEASE_INDICATOR,
    DEPRESSION_INDICATOR,
    DIABETES_INDICATOR,
    ISCHEMIC_HEART_DISEASE_INDICATOR,
    OSTEOPOROSIS_INDICATOR,
    RHEUMATOID_ARTHRITIS_AND_OSTEOARTHRITIS_INDICATOR,
    STROKE_TRANSIENT_ISCHEMIC_ATTACK_INDICATOR,
    MEDICAL_REIMBURSEMENT_INPATIENT,
    BENEFICIARY_RESIDUAL_INPATIENT,
    PER_PATIENT_PER_YEAR_PAYMENT_INPATIENT,
    MEDICAL_REIMBURSEMENT_OUTPATIENT,
    BENEFICIARY_RESIDUAL_OUTPATIENT,
    PER_PATIENT_PER_YEAR_PAYMENT_OUTPATIENT,
    MEDICAL_REIMBURSEMENT_CARRIER,
    BENEFICIARY_RESIDUAL_CARRIER,
    PER_PATIENT_PER_YEAR_PAYMENT_CARRIER,
    source_file_name,
    loaded_timestamp
)
FROM (
    SELECT
        $1 AS DESYNPUF_ID,
        TO_DATE($2, 'YYYY-MM-DD') AS BENEFICIARY_BIRTH_DATE,
        TO_DATE($3, 'YYYY-MM-DD') AS BENEFICIARY_DEATH_DATE,
        $4 AS BENEFICIARY_SEX_ID_CODE,
        $5 AS BENEFICIARY_RACE_CODE,
        $6 AS BENEFICIARY_END_STAGE_RENAL_DISEASE_INDICATOR,
        $7 AS STATE_CODE,
        $8 AS BENEFICIARY_COUNTY_CODE,
        CAST($9 AS INTEGER) AS BENEFICIARY_HOSPITAL_INSURANCE_COVERAGE_TOTAL_MONTHS,
        CAST($10 AS INTEGER) AS BENEFICIARY_SUPPLEMENTARY_MEDICAL_INSURANCE_COVERAGE_TOTAL_MONTHS,
        CAST($11 AS INTEGER) AS BENEFICIARY_HEALTH_MAINTENANCE_ORGANIZATION_COVERAGE_TOTAL_MONTHS,
        CAST($12 AS INTEGER) AS PLAN_COVERAGE_MONTHS_NUMBER,
        CAST($13 AS BOOLEAN) AS ALZHEIMER_DISEASE_INDICATOR,
        CAST($14 AS BOOLEAN) AS CONGESTIVE_HEART_FAILURE_INDICATOR,
        CAST($15 AS BOOLEAN) AS CHRONIC_KIDNEY_DISEASE_INDICATOR,
        CAST($16 AS BOOLEAN) AS CANCER_INDICATOR,
        CAST($17 AS BOOLEAN) AS CHRONIC_OBSTRUCTIVE_PULMONARY_DISEASE_INDICATOR,
        CAST($18 AS BOOLEAN) AS DEPRESSION_INDICATOR,
        CAST($19 AS BOOLEAN) AS DIABETES_INDICATOR,
        CAST($20 AS BOOLEAN) AS ISCHEMIC_HEART_DISEASE_INDICATOR,
        CAST($21 AS BOOLEAN) AS OSTEOPOROSIS_INDICATOR,
        CAST($22 AS BOOLEAN) AS RHEUMATOID_ARTHRITIS_AND_OSTEOARTHRITIS_INDICATOR,
        CAST($23 AS BOOLEAN) AS STROKE_TRANSIENT_ISCHEMIC_ATTACK_INDICATOR,
        CAST($24 AS FLOAT) AS MEDICAL_REIMBURSEMENT_INPATIENT,
        CAST($25 AS FLOAT) AS BENEFICIARY_RESIDUAL_INPATIENT,
        CAST($26 AS FLOAT) AS PER_PATIENT_PER_YEAR_PAYMENT_INPATIENT,
        CAST($27 AS FLOAT) AS MEDICAL_REIMBURSEMENT_OUTPATIENT,
        CAST($28 AS FLOAT) AS BENEFICIARY_RESIDUAL_OUTPATIENT,
        CAST($29 AS FLOAT) AS PER_PATIENT_PER_YEAR_PAYMENT_OUTPATIENT,
        CAST($30 AS FLOAT) AS MEDICAL_REIMBURSEMENT_CARRIER,
        CAST($31 AS FLOAT) AS BENEFICIARY_RESIDUAL_CARRIER,
        CAST($32 AS FLOAT) AS PER_PATIENT_PER_YEAR_PAYMENT_CARRIER,
        METADATA$FILENAME AS source_file_name,
        CURRENT_TIMESTAMP AS loaded_timestamp
    --TODO Replace the static csv with a variable
    FROM @raw_beneficiary_stage//customer_1_beneficiary.csv
)
FILE_FORMAT = (
    TYPE = 'CSV',
    FIELD_OPTIONALLY_ENCLOSED_BY = '\"',
    SKIP_HEADER = 1
);
